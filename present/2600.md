## Agenda

- Project Zero: Exploiting the DRAM rowhammer bug to gain kernel privileges

- mroth/unindexed

- USB Killer

- Generate Passwords

- carmaa/inception

- Stop using tail -f (mostly)

- daniel.haxx.se  The state and rate of HTTP/2 adoption

- Amazon Home Services : Amazon.com

- NSA Backdoor Key from Lotus-Notes

- How I Cracked Trivia Crack - Randy Westergren

- Google Online Security Blog: Maintaining digital certificate security

- How "../sms" could bypass Authy 2 Factor Authentication

- ircmaxell's blog: Security Issue: Combining Bcrypt With Other Hash Functions

- Security/Features - Ubuntu Wiki

- To Avoid NSA Interception, Cisco Will Ship To Decoy Addresses

- Popular torrent client can steal your CPU cycles to mine Bitcoins

- Slashdot

- State Machine AttACKs against TLS (SMACK TLS)

[]()

.footnote[Random]

---

## State Machine AttACKs against TLS (SMACK TLS)

- This page presents exploits and disclosure information related to these attacks.

- Message SKIPping Attacks

- the server authentication guarantee relies on the Server Key Exchange message in ephemeral Diffie-Hellman cipher suites (including ECDHE), whereas this message is completely skipped in the RSA key exchange

- We find that several TLS implementations incorrectly allow some messages to be skipped even though they are required for the selected cipher suite.

- JSSE clients allow the peer to skip all messages related to key exchange and authentication.

- FREAK: Factoring RSA Export Keys

- This attack targets a class of deliberately weak export cipher suites. As the name implies, this class of algorithms have been introduced under the pressure of US governments agencies to ensure that the NSA would be able to decrypt all foreign encrypted communication, while stronger algorithms were be banned from export (as they were classified as weapons of war).

- we discovered that several implementations incorrectly allow the message sequence of export ciphersuites to be used even if a non-export ciphersuite was negotiated.

- Thus, if a server is willing to negotiate an export ciphersuite, a man-in-the-middle may trick a browser (which normally doesn't allow it) to use a weak export key

- By design, export RSA moduli must be less than 512 bits long; hence, they can be factored in less than 12 hours for $50 on Amazon EC2.

[https://www.smacktls.com/](https://www.smacktls.com/)

.footnote[None]

---

## Slashdot

- The BlackPhone, a $600-plus encrypted Android handset designed to keep the prying eyes of criminals and the government out of mobile communications, is now fully owned by Silent Circle thanks to the company raking in investment cash

- Silent Circle said Thursday that it has raised $50 million and plans on showing off an encrypted 'enterprise privacy ecosystem' at World Mobile Congress next week. A BlackPhone tablet is on the way, too.

[http://m.slashdot.org/story/214159](http://m.slashdot.org/story/214159)

.footnote[None]

---

## Popular torrent client can steal your CPU cycles to mine Bitcoins

- If you recently installed or updated uTorrent on your PC, you may have have picked up an unwanted passenger

- a Bitcoin miner called Epic Scale

- that piece of code can be inadvertently installed with the latest uTorrent build (version 3.4.2)

- use your computer as part of a Bitcoin farm (Litecoin, to be exact)

[http://www.engadget.com/2015/03/06/utorrent-bitcoin-miner/](http://www.engadget.com/2015/03/06/utorrent-bitcoin-miner/)

.footnote[None]

---

## To Avoid NSA Interception, Cisco Will Ship To Decoy Addresses

- An anonymous reader writes with this news snipped from The Register: Cisco will ship boxes to vacant addresses in a bid to foil the NSA, security chief John Stewart says.

- The dead drop shipments help to foil a Snowden-revealed operation whereby the NSA would intercept networking kit and install backdoors before boxen reached customers.

- The interception campaign was revealed last May.

- Speaking at a Cisco Live press panel in Melbourne today, Stewart says the Borg will ship to fake identities for its most sensitive customers, in the hope that the NSA's interceptions are targeted.

- 'We ship [boxes] to an address that has nothing to do with the customer, and then you have no idea who, ultimately, it is going to,' Stewart says.

[http://hardware.slashdot.org/story/15/03/19/1453212/to-avoid-nsa-interception-cisco-will-ship-to-decoy-addresses](http://hardware.slashdot.org/story/15/03/19/1453212/to-avoid-nsa-interception-cisco-will-ship-to-decoy-addresses)

.footnote[None]

---

## Security/Features - Ubuntu Wiki

- Cloud PRNG seed

- Pollinate is a client application that retrieves entropy from one or more Pollen servers and seeds the local Pseudo Random Number Generator (PRNG)

- Starting with Ubuntu 14.04 LTS, Ubuntu cloud images include the Pollinate client, which will try to seed the PRNG with input from https://entropy.ubuntu.com for up to 3 seconds on first boot.

[https://wiki.ubuntu.com/Security/Features](https://wiki.ubuntu.com/Security/Features)

.footnote[None]

---

## ircmaxell's blog: Security Issue: Combining Bcrypt With Other Hash Functions

- question on StackOverflow asking if password_verify() was safe against DoS attacks using extremely long passwords

- Bcrypt is limited to 72 character passwords. So on the surface it looks like it shouldn't be vulnerable

- if *ptr is ever 0, then reset it to the start of the string

- That means that "test\0abc" would be treated as "test\0test\0test\0test\0test\0test\0test\0test\0test\0test\0test\0test\0test\0test\0te". In fact, every string that starts with "test\0" will be treated the same.

- this is by-design. And it's not an issue because nobody uses passwords with null bytes.

- Some people think bcrypt isn't enough, and instead choose to "pre-hash" passwords.

- some people want to use a "pepper", so they pre-hash using a HMAC with a private key

- The problem here is the last argument to the two hash functions: true. They force raw output.

- it means that on average 1 out of every 256 passwords (or 0.39%) will have a leading null byte

[http://blog.ircmaxell.com/2015/03/security-issue-combining-bcrypt-with.html](http://blog.ircmaxell.com/2015/03/security-issue-combining-bcrypt-with.html)

.footnote[None]

---

## How "../sms" could bypass Authy 2 Factor Authentication

- I responsibly disclosed this vulnerability to Authy on February 8 and worked with them to fix the issue that same day.  There are two API calls:   The client requests new token: http://api.authy.com/protected/json/sms/AUTHY_ID?api_key=KEY where AUTHY_ID is publicly available identifier associated with current user account.

- ","token":"is valid"}   Authy-node does not encode token from user params There was a blatant bug in authy-node (not an official library, btw another popular node library wasnt vulnerable) - token supplied by the user was not URL encoded at all: this._request("get", "/protected/json/verify/" + token + "/" + id, {}, callback, qs); Which means by typing VALID_TOKEN_FOR_OTHER_AUTHY_ID/OTHER_AUTH_ID# we would overwrite the path and make the client send /protected/json/verify/VALID_TOKEN_FOR_OTHER_AUTHY_ID/OTHER_AUTH_ID#/AUTH_ID.

- Everyone is vulnerable! Few hours later I realized what made path traversal work: I recently read Daniels interview on Authy and recalled it runs Sinatra, which uses rack-protection by default. It turns out even URL encoding was futile - path_traversal module in rack-protection was decoding %2f back to slashes!

- This is also a great example how libraries or features that aim to add security actually introduce security vulnerabilities (see also CSP for evil and XSS auditor for evil)    The attacker types ../sms in the SMS token field   The client app encodes it as ..%2fsms and makes an API call to Authy - https://api.authy.com/protected/json/verify/..%2fsms/authy_id   Path_traversal middleware decodes path to https://api.authy.com/protected/json/verify/../sms/authy_id, splits by slashes and removes the directory in front of /...   Actual Authy API sees modified path https://api.authy.com/protected/json/sms/authy_id, simply sends another SMS to authy_id (the victim) and responds with 200 status and {"success":true,"message":"SMS token was sent","cellphone":"+1-XXX-XXX-XX85"}   All Authy SDK libraries consider 200 status as a successful response and let the attacker in.

- So the only secure way to verify the response is to search for "token":"is valid" substring (which is what Authy libraries do now).   Yes, the attacker was able to bypass 2 factor authentication on any website using Authy with something as simple as ../sms in the token field! Timeline: reported on Feb 8, the path_traversal module was patched right away and we waited for a month to let authy-node users to update. Update 20 March Authy contacted me to clarify that not everybody was vulnerable, and vulnerable API libraries were limited to Node.JS by Daniel Barnes, Authy.NET by Devin Martin and Authy OpenVPN. This is another example of format injection and why you need to treat URLs as a format like JSON or XML.

[http://sakurity.com/blog/2015/03/15/authy_bypass.html](http://sakurity.com/blog/2015/03/15/authy_bypass.html)

.footnote[None]

---

## Google Online Security Blog: Maintaining digital certificate security

-  On Friday, March 20th, we became aware of unauthorized digital certificates for several Google domains.

-  CNNIC is included in all major root stores and so the misissued certificates would be trusted by almost all browsers and operating systems.

- This situation is similar to a failure by ANSSI in 2013. This explanation is congruent with the facts.

- To assist customers affected by this decision, for a limited time we will allow CNNICs existing certificates to continue to be marked as trusted in Chrome, through the use of a publicly disclosed whitelist.

- We applaud CNNIC on their proactive steps, and welcome them to reapply once suitable technical and procedural controls are in place.

[http://googleonlinesecurity.blogspot.com/2015/03/maintaining-digital-certificate-security.html](http://googleonlinesecurity.blogspot.com/2015/03/maintaining-digital-certificate-security.html)

.footnote[None]

---

## How I Cracked Trivia Crack - Randy Westergren

- Its the latest craze in social gaming, allowing users to compete against their friends and strangers in answering questions from an array of categories.

- After watching her play for a while, I decided to download it and take a closer look into how it was implemented. I began by monitoring the web API requests made over the network while using the Android app.

- It seemed that the app was receiving the category, question, and answer from the Trivia Crack servers before the user even began spinning the category wheel.  Below is an example response that the app fetches prior to showing this screen: JavaScript { "id": 2747994099, "opponent": { "id": 0, "alerts_count": 0, "username": "smartplay(tm)" }, "game_status": "PENDING_APPROVAL", "language": "EN", "created": "03/23/2015 08:58:29 EST", "last_turn": "03/23/2015 08:58:29 EST", "type": "NORMAL", "expiration_date": "03/26/2015 08:58:29 EST", "my_turn": true, "statistics": { "player_one_statistics": { "category_questions": [ { "category": "GEOGRAPHY", "correct": 1, "incorrect": 0, "worst": false } ], "correct_answers": 1, "incorrect_answers": 0, "challenges_won": 0, "questions_answered": 1, "crowns_won": 0 }, "player_two_statistics": { "correct_answers": 0, "incorrect_answers": 0, "challenges_won": 0, "questions_answered": 0, "crowns_won": 0 } }, "duelGameType": false, "normalType": true, "spins_data": { "spins": [ { "type": "NORMAL", "questions": [ { "question": { "id": 14996887, "category": "SPORTS", "text": "Who was the first woman gymnast to score a perfect ten at the Olympics?

- While not exactly ethical or fair for gaming use, I thought it would be interesting research. My initial plan was to reverse engineer the Android app and provide the user with a Toast notification of the answer.

- Note this is for research purposes only; I am not responsible for any immoral gameplay! This should serve as a good example that client application privacy cannot be guaranteed and developers should be careful about whats included in their compiled releases. Share this: 

[http://randywestergren.com/how-i-cracked-trivia-crack/](http://randywestergren.com/how-i-cracked-trivia-crack/)

.footnote[None]

---

## NSA Backdoor Key from Lotus-Notes

- This page has also been translated into Russian here and into Polish here  Before the US crypto export regulations were finally disolved the export version of Lotus Notes used to include a key escrow / backdoor feature called differential cryptography.

- The NSA would then only have the small matter of brute-forcing the remaining 40 bits to get the plaintext, and everyone else would get a not-that-great 64 bit key space (which probably already back then NSA would have had the compute power to brute force also, only at higher cost). Anyway as clearly inside the application somewhere would be an NSA public key that the NSA had the private key for, I tried reverse engineering it to get the public key. In doing this I discovered that the NSA public key had an organizational name of "MiniTruth", and a common name of "Big Brother".

- Specifically what I saw in my debugger late one night, which was spooky for a short moment was: Literary note: for those who have not read Orwell's prescient "1984" the Ministry of Truth was the agency who's job was propaganda and suppression of truths that did not suit the malignant fictional future government in the book, and "Big Brother" was the evil shadowy leader of this government.

- The whole book is online here. The NSA's Public Key I put this together some years after the reverse-engineering stint, so there could be errors, but this is from my notes, the raw public key modulus from the debugger: I figured it was in little endian format by trial and error; other formats were easy to factor.

- So the big endian hex representation is:  e = 3 n = \ 00BB9558CD8B68310CF73A12E31FC44BD87BE0C4FE2EB8B6EA0F4FB0684F9559\ F656E9123EE175607612C3ECC580BCE78C3388CF23468450FB67CE61B51181DF\ A047B9B83318B472FE3929ABCA8EE51206FFE9B899AECEA5A703EFD313629D8D  where the modulus is 760 bits, and the public key formatted as a PGP key is (of course I made this user id up -- you can edit it to whatever you choose it's of course not self-signed): and here's what pgpacket has to say about the contents of that key:  Comments, html bugs to (Adam Back) at adam@cypherspace.org 

[http://www.cypherspace.org/adam/hacks/lotus-nsa-key.html](http://www.cypherspace.org/adam/hacks/lotus-nsa-key.html)

.footnote[None]

---

## Amazon Home Services : Amazon.com

- Amazon Home Services is a new and simple way to buy and schedule professional services such as furniture assembly, house cleaning, and lawn care directly on Amazon.

- Service pros compete for your business based on price, quality, and availability.

- If customers find a lower price for the same service and pro, we will match it.

- Your Amazon account is only charged after the service is completed.

- If youre not 100% satisfied, Amazon will make it right or give you a full refund. Amazon Home Services is currently available in the following cities: Los Angeles, Miami, San Francisco, New York, Houston, Seattle, Chicago, Washington DC, Philadelphia, Boston, Dallas, Atlanta, Phoenix, San Diego, San Jose, Portland, Minneapolis, Detroit, Baltimore, Denver, Riverside, Tampa, Orlando, Austin, Sacramento, Pittsburgh, Nashville, Cincinnati, Charlotte, and St. Louis.

[http://www.amazon.com/services](http://www.amazon.com/services)

.footnote[None]

---

## daniel.haxx.se  The state and rate of HTTP/2 adoption

-  The protocol HTTP/2 as defined in the draft-17 was approved by the IESG and is being implemented and deployed widely on the Internet today, even before it has turned up as an actual RFC.

- Back in February, already upwards 5% or maybe even more of the web traffic was using HTTP/2. My prediction: Well see 10% usage by the end of the year, possibly as much as 20-30% a little depending on how fast some of the major and most popular platforms will switch (Facebook, Instagram, Tumblr, Yahoo and others).

- In 2016 we might see HTTP/2 serve a majority of all HTTP requests  done by browsers at least. Counted how? Yeah the second I mention a rate I know you guys will start throwing me hard questions like exactly what do I mean.

- I havent gotten a straight answer from that team, but Willy Tarreau has been actively participating in the HTTP/2 work all the time so I expect them to have work in progress. While very critical to the protocol, PHK of the Varnish project has said that Varnish will support it if it gets traction. My estimate: By the end of 2015, the leading proxy software projects will start to have or are already shipping HTTP/2 support. Services Google (including Youtube and other sites in the Google family) and Twitter have ran HTTP/2 enabled for months already. Lots of existing services offer SPDY today and I would imagine most of them are considering and pondering on how to switch to HTTP/2 as Chrome has already announced them going to drop SPDY during 2016 and Firefox will also abandon SPDY at some point. My estimate: By the end of 2015 lots of the top sites of the world will be serving HTTP/2 or will be working on doing it. Content Delivery Networks Akamai plans to ship HTTP/2 by the end of the year.

- This is how the 64 responses I received were distributed:  Evidently, if you take a median out of these results you can see that the middle point is between 5-10 and 10-15.

[http://daniel.haxx.se/blog/2015/03/31/the-state-and-rate-of-http2-adoption/](http://daniel.haxx.se/blog/2015/03/31/the-state-and-rate-of-http2-adoption/)

.footnote[None]

---

## Stop using tail -f (mostly)

- less +F

[http://www.brianstorti.com/stop-using-tail/?utm_campaign=buffer_content=buffer13c97_medium=social_source=twitter.com](http://www.brianstorti.com/stop-using-tail/?utm_campaign=buffer_content=buffer13c97_medium=social_source=twitter.com)

.footnote[None]

---

## carmaa/inception

- Inception aims to provide a relatively quick, stable and easy way of performing intrusive and non-intrusive memory hacks against live computers using DMA.

- Once DMA is granted, the tool proceeds to search through available memory pages for signatures at certain offsets in the operating systems code.

- module is primarily attended to do its magic against computers that utilize full disk encryption such as BitLocker, FileVault, TrueCrypt or Pointsec.

- If your the target has more then that, you need to be lucky in order to find the signatures mapped to a physical memory page frame that the tool can reach.

- As an example, to create a reverse TCP meterpreter shell from the target machine to your attacking host, first start the msfrpcd dameon, and then launch a console listening for callbacks.

[https://github.com/carmaa/inception](https://github.com/carmaa/inception)

.footnote[None]

---

## Generate Passwords

- This code generates passwords, using a markov model containing Huffman trees.

- Traversing the Huffman trees allows selection of a letter to consume few bits for common choices and many bits for uncommon ones, allowing "biasing" toward more common sequences without compromising the randomness of the generated passwords. This particular engine is based on Charles Dickens' A Tale of Two Cities, although the entropy of the generated passwords is independent of the choice of source text. Another way of looking at this is that we're "decompressing" a random bit string into english text. How many bits? Here are some fresh passwords for you.

- Click "refresh" for another set. Which column would you rather memorize?  bitspassword NOT YETNOT YET  Fine print: yes, they're secure.

- Naturally, it's all in Racket Also, in case it wasn't obvious, the tool generated its own name, "Molis Hai".

- In fact, it generated the string "There twass molis hai", which sounds something like a proclamation. Finally, many thanks to Zachary Peterson, @znjp, for pointing me to all kinds of related work.

[http://www.brinckerhoff.org/molis-hai/pwgen-3.html](http://www.brinckerhoff.org/molis-hai/pwgen-3.html)

.footnote[None]

---

## USB Killer

- But then a friend told about... (a quote from a chat in Skype): I read an article about how a dude in the subway fished out a USB flash drive from the outer pocket of some guys bag.

- He wrote 129 on the USB drive and now has it in the outer pocket of his bag... A Picture to Attract Attention:  Since I work in the company engaged in the development and manufacture of electronics, my colleagues and I are began to discuss options for creating a USB flash drive, that would burn half a laptop down. We had plenty of hardcore, fantastic, as well as quite real, options.

- This fun discussion could have been the end of the story, if I was not going to order the production of printed circuit boards for other projects. As a rule, the USB interface of a computer has a USB plug connection - ESD diodes (static protection) - filter elements - security elements in the chip that contains the physical layer of the USB interface.

- When we connect it up to the USB port, an inverting DC/DC converter runs and charges capacitors to -110V.

- Ill explain to others that negative voltage is easier to commutate, as we need the N-channel field resistor, which, unlike the P-channel one, can have larger current for the same dimensions. Im not going to talk to you about the application area, but a former colleague says that its like an atomic bomb: cool to have, but can not be applied. Arriving at work, you find a USB drive on your table.

[http://kukuruku.co/hub/diy/usb-killer](http://kukuruku.co/hub/diy/usb-killer)

.footnote[None]

---

## mroth/unindexed

- The site is constantly searching for itself in Google, over and over and over, 24 hours a day. The instant it finds itself in Google search results, the site will instantaneously and irrevocably securely delete itself.

[https://github.com/mroth/unindexed](https://github.com/mroth/unindexed)

.footnote[None]

---

## Project Zero: Exploiting the DRAM rowhammer bug to gain kernel privileges

- Flushing the cache using CLFLUSH forces the memory accesses to be sent to the underlying DRAM, which is necessary to cause the rows to be repeatedly activated. Note that the papers version of code1a also includes an MFENCE instruction.

- via /proc/PID/pagemap or huge pages). Exploiting rowhammer bit flips Yoongu Kim et al say that With some engineering effort, we believe we can develop Code 1a into a disturbance attack that ... hijacks control of the system, but say that they leave this research task for the future.

- Whether this is feasible could depend on the associativity of these caches. If this is possible, it would be a serious problem, because it might be possible to generate bit flips from JavaScript code on the open web, perhaps via JavaScript typed arrays.   Non-temporal memory accesses: On x86, these include non-temporal stores (MOVNTI, MOVNTQ, MOVNTDQ(A), MOVNTPD, MOVNTSD and MOVNTSS) and non-temporals reads (via prefetches  PREFETCHNTA).   Atomic memory accesses: Some reports claim that non-malicious use of spinlocks can cause row hammering, although the reports have insufficient detail and weve not been able to verify this.

- These mechanisms can be repurposed by a defender to monitor the system for sudden bursts of cache misses, as truly cache-pessimal access patterns appear to be rare in typical laptop and desktop workloads.

- By measuring time elapsed per N cache misses and monitoring for abnormal changes, we have been able to detect aggressive hammering even on systems that were running under a heavy load (a multi-core Linux kernel compile) during the attack.

[http://googleprojectzero.blogspot.com/2015/03/exploiting-dram-rowhammer-bug-to-gain.html](http://googleprojectzero.blogspot.com/2015/03/exploiting-dram-rowhammer-bug-to-gain.html)

.footnote[Infosec]

---

